<!doctype html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8" />
  <title>Profile</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!--  <link rel="stylesheet" th:href="@{/css/styles.css}">-->
  <style>
    body {
      margin: 0;
      background: linear-gradient(to bottom, #f9f9f9, #ffb7ce);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      min-height: 100vh;
    }

    .navbar {
      background-color: white;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 15px 0;
    }

    .nav-container {
      max-width: 980px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
    }

    .nav-brand {
      font-size: 1.5rem;
      font-weight: 700;
      color: #ff6b95;
      text-decoration: none;
    }

    .nav-brand:hover {
      color: #ff4d7a;
    }

    .notif-icon {
      position: relative;
    }

    .notif-icon a {
      color: #ff6b95;
      text-decoration: none;
      display: flex;
      align-items: center;
    }

    .notif-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background-color: #ff4757;
      color: white;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      font-size: 0.75rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .nav-profile img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #e6edf3;
    }

    .profile-container {
      max-width: 980px;
      margin: 28px auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 24px;
      align-items: center;
    }

    .profile-card {
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(13, 30, 49, 0.06);
      padding: 30px;
      text-align: center;
      width: 100%;
      max-width: 600px;
    }

    .profile-avatar {
      width: 140px;
      height: 140px;
      margin: 0 auto 14px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid #f3f6f9;
      box-shadow: 0 4px 12px rgba(10, 30, 60, 0.06);
    }

    .profile-name {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .profile-role {
      font-size: 16px;
      color: #667085;
      margin-bottom: 12px;
    }

    .profile-meta {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
      font-size: 14px;
      color: #475569;
    }

    .profile-meta .meta-item {
      padding: 10px 20px;
      background: #fbfdff;
      border-radius: 8px;
      box-shadow: inset 0 -1px 0 rgba(15,23,42,0.02);
    }

    .meta-title {
      font-size: 12px;
      color: #667085;
    }

    .meta-value {
      font-size: 18px;
      font-weight: 600;
      color: #ff6b95;
    }

    .followers-links {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 15px 0;
    }

    .followers-links a {
      color: #ff6b95;
      text-decoration: none;
      font-weight: 500;
      font-size: 16px;
    }

    .followers-links a:hover {
      text-decoration: underline;
    }

    .follow-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 10px 20px;
      margin: 10px 0;
      background: #ff6b95;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      transition: background-color 0.2s;
      font-size: 14px;
    }

    .follow-btn:hover {
      background: #ff4d7a;
    }

    .follow-btn:disabled {
      background: #cbd5e1;
      cursor: not-allowed;
    }

    .logout-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      width: 100%;
      max-width: 200px;
      padding: 10px 16px;
      margin-top: 16px;
      background: #ff4757;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      transition: background-color 0.2s;
      font-size: 14px;
    }

    .logout-btn:hover {
      background: #ff3742;
    }

    .back-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      width: 100%;
      max-width: 200px;
      padding: 10px 16px;
      margin-top: 10px;
      background: #6c757d;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      transition: background-color 0.2s;
      font-size: 14px;
    }

    .back-btn:hover {
      background: #5a6268;
    }

    .profile-details {
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(13, 30, 49, 0.06);
      padding: 30px;
      width: 100%;
      max-width: 600px;
    }

    .profile-section-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 16px;
      color: #334155;
      border-bottom: 1px solid #eef2f7;
      padding-bottom: 8px;
    }

    .field-row {
      display: flex;
      gap: 12px;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px dashed #eef2f7;
    }
    .field-row:last-child { border-bottom: none; }
    .field-label {
      width: 140px;
      color: #475569;
      font-weight: 500;
    }
    .field-value {
      color: #0f172a;
      word-break: break-word;
    }

    .profile-form .form-group {
      margin-bottom: 16px;
    }
    .profile-form label {
      display: block;
      margin-bottom: 6px;
      font-size: 14px;
      color: #334155;
      font-weight: 500;
    }
    .profile-form input[type="text"],
    .profile-form input[type="email"],
    .profile-form textarea,
    .profile-form select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #e6edf3;
      border-radius: 8px;
      background: #fff;
      font-size: 14px;
      outline: none;
      transition: border-color 0.2s;
    }

    .profile-form input[type="text"]:focus,
    .profile-form input[type="email"]:focus {
      border-color: #ff6b95;
      box-shadow: 0 0 0 2px rgba(255, 107, 149, 0.1);
    }

    .profile-form textarea {
      min-height: 100px;
      resize: vertical;
    }

    .btn {
      display: inline-block;
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      text-decoration: none;
      text-align: center;
      transition: all 0.2s;
      font-size: 14px;
    }
    .btn-primary {
      background: #ff6b95;
      color: #fff;
      box-shadow: 0 4px 12px rgba(255, 107, 149, 0.3);
    }
    .btn-primary:hover {
      background: #ff4d7a;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(255, 107, 149, 0.4);
    }
    .btn-secondary {
      background: #f1f5f9;
      color: #0f172a;
    }
    .btn-secondary:hover {
      background: #e2e8f0;
    }

    .activity-list {
      margin-top: 16px;
    }

    .activity-item {
      display: flex;
      align-items: flex-start;
      padding: 16px 0;
      border-bottom: 1px solid #f1f5f9;
    }

    .activity-item:last-child {
      border-bottom: none;
    }

    .activity-icon {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background-color: #ffe4ec;
      color: #ff6b95;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .activity-content {
      flex: 1;
    }

    .activity-description {
      margin-bottom: 4px;
      color: #334155;
    }

    .activity-meta {
      display: flex;
      font-size: 12px;
      color: #64748b;
      gap: 12px;
    }

    .no-activity {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 30px;
      color: #94a3b8;
      background-color: #f8fafc;
      border-radius: 8px;
      margin-top: 16px;
      font-style: italic;
    }

    .posts-section {
      margin-top: 30px;
    }

    .post-item {
      background-color: #f8fafc;
      padding: 16px;
      margin-bottom: 16px;
      border-radius: 8px;
      border-left: 4px solid #ff6b95;
    }

    .post-date {
      font-size: 12px;
      color: #64748b;
      margin-top: 8px;
    }

    hr {
      border: 0;
      border-top: 1px solid #e2e8f0;
      margin: 24px 0;
    }

    @media (max-width: 768px) {
      .profile-container {
        padding: 12px;
      }

      .profile-avatar {
        width: 110px;
        height: 110px;
      }

      .field-label {
        width: 100px;
        font-size: 13px;
      }

      .profile-meta {
        flex-direction: column;
        gap: 10px;
      }

      .followers-links {
        flex-direction: column;
        gap: 10px;
      }

      .nav-container {
        flex-wrap: wrap;
        gap: 10px;
      }
    }
  </style>
</head>
<body>
<!-- Navigation Bar -->
<nav class="navbar">
  <div class="nav-container">
    <a th:href="@{/posts}" class="nav-brand">Posts</a>
    <a th:href="@{/pets/main}" class="nav-brand">PawPal</a>
    <a th:href="@{/api/users/main}" class="nav-brand">Users</a>
    <div class="notif-icon">
      <a th:href="@{/notifications}" title="Notifications">
        <i class="fa-solid fa-bell" style="font-size: 20px; color: pink;"></i>
        <span th:if="${#lists.size(requests) + #lists.size(postNotifications) > 0}"
              th:text="${#lists.size(requests) + #lists.size(postNotifications)}"
              class="notif-badge"></span>
      </a>
    </div>
    <div class="nav-profile">
      <a th:href="@{/api/users/viewProfile/{id}(id=${user.userId})}">
        <img th:src="@{${user.profilePicture != null ? user.profilePicture : '/css/images/default-avatar.jpg'}}"
             alt="Profile"
             onerror="this.src='/css/images/default-avatar.jpg'">
      </a>
    </div>
  </div>
</nav>

<!-- Main Content -->
<div class="profile-container">
  <!-- Profile Card -->
  <div class="profile-card">
    <img class="profile-avatar"
         th:src="@{${userProfile.profilePicture != null ? userProfile.profilePicture : '/css/images/default-avatar.jpg'}}"
         alt="avatar" />
    <div class="profile-name" th:text="${userProfile.userName}">Username</div>
    <!-- Followers / Following -->
    <div class="followers-links">
      <div>
        <a th:href="@{/follow/{id}/followers(id=${userProfile.userId})}">
          <span class="font-bold text-lg" th:text="${followersCount}">0</span> Followers
        </a>
      </div>
      <div>
        <a th:href="@{/follow/{id}/following(id=${userProfile.userId})}">
          <span class="font-bold text-lg" th:text="${followingCount}">0</span> Following
        </a>
      </div>
    </div>

    <div th:if="${!isOwner}">
      <form th:if="${!isFollowing}" th:action="@{/follow/request/{id}(id=${userProfile.userId})}" method="post">
        <button type="submit" class="follow-btn">
          Follow
        </button>
      </form>
      <button th:if="${isFollowing}" class="follow-btn" disabled>
        Following
      </button>
    </div>

    <div class="profile-meta">
      <div class="meta-item">
        <div class="meta-title">Pets</div>
        <div class="meta-value" th:text="${userProfile.petIds != null ? #lists.size(userProfile.petIds) : 0}">0</div>
      </div>
    </div>
  </div>

  <!-- Profile Details -->
  <div class="profile-details">
    <!-- User Info -->
    <div class="profile-section-title">Info</div>

    <div class="field-row">
      <div class="field-label">Email</div>
      <div class="field-value" th:text="${userProfile.email}">user@example.com</div>
    </div>
    <!-- Posts Section -->
    <div class="posts-section">
      <h2 class="profile-section-title">Posts</h2>

      <div th:if="${#lists.isEmpty(posts)}">
        <p class="no-activity">No posts yet.</p>
      </div>

      <div th:each="post : ${posts}" class="post-item">
        <p th:text="${post.postContent}" class="mb-2"></p>
        <div class="post-date" th:text="'Posted on ' + ${#temporals.format(post.postDate, 'yyyy-MM-dd HH:mm')}"></div>
      </div>
<!--      <div th:each="post : ${posts}" class="post-card">-->
<!--        <div class="post-header">-->
<!--          &lt;!&ndash;            <div class="post-user">&ndash;&gt;-->
<!--          &lt;!&ndash;                <i class="fa-solid fa-user" style="margin-right: 8px; color: #667eea;"></i>&ndash;&gt;-->
<!--          &lt;!&ndash;                <span th:text="${post.userName}">username</span>&ndash;&gt;-->
<!--          &lt;!&ndash;            </div>&ndash;&gt;-->
<!--          <div class="post-user">-->
<!--            <i class="fa-solid fa-user" style="margin-right: 8px; color: #667eea;"></i>-->
<!--            <a th:href="@{/api/users/viewUserProfile/{id}(id=${post.userId})}"-->
<!--               th:text="${post.userName}"-->
<!--               class="username-link">username</a>-->
<!--          </div>-->
<!--          <div class="post-date">-->
<!--            <i class="fa-solid fa-calendar" style="margin-right: 6px;"></i>-->
<!--            <span th:text="${#temporals.format(post.postDate, 'dd MMM yyyy')}">date</span>-->
<!--          </div>-->
<!--        </div>-->

<!--        <div class="post-content" th:text="${post.postContent}">Post content here</div>-->

<!--        &lt;!&ndash; Галерея фотографий &ndash;&gt;-->
<!--        <div th:if="${post.postPhotos != null && !post.postPhotos.isEmpty()}" class="post-photos">-->
<!--          <div th:each="photo : ${post.postPhotos}">-->
<!--            <img th:src="@{${photo}}" alt="Post Photo" class="post-photo"-->
<!--                 onerror="this.style.display='none'"/>-->
<!--          </div>-->
<!--        </div>-->

<!--        <div class="post-actions">-->
<!--          <div class="action-buttons">-->
<!--            &lt;!&ndash; Комментарии &ndash;&gt;-->
<!--            <a th:href="@{/posts/{id}/comments(id=${post.postId})}" class="comment-btn">-->
<!--              <i class="fa-solid fa-comment"></i> Comment-->
<!--            </a>-->

<!--          <span class="likes-count" th:text="${post.likeCount} + ' likes'">0 likes</span>-->

<!--          <form th:action="@{/posts/{id}/like(id=${post.postId})}" method="post" style="display:inline;">-->
<!--            <button type="submit" class="like-btn" th:classappend="${post.likedByCurrentUser} ? 'active' : ''">-->
<!--              <i th:class="${post.likedByCurrentUser} ? 'fa-solid' : 'fa-regular'" class="fa-heart"></i>-->
<!--              <span th:text="${post.likedByCurrentUser} ? 'Unlike' : 'Like'">Like</span>-->
<!--            </button>-->
<!--          </form>-->

<!--        </div>-->
<!--      </div>-->

      <!-- Сообщение если постов нет -->
      <div th:if="${#lists.isEmpty(posts)}" class="no-posts">
        <i class="fa-solid fa-newspaper" style="font-size: 48px; color: #ccc; margin-bottom: 16px;"></i>
        <h3>No posts yet</h3>
      </div>
    </div>
    </div>
  </div>
</div>
</body>
</html>